var __awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})},ExportHelper;(function(n){function l(t,i,r,u=false){return __awaiter(this,void 0,void 0,function*(){t===n.ExportMode.LocalWord?yield n.exportToLocalWord(i):(t===n.ExportMode.OnlineWord||t===n.ExportMode.OnlineWord1st)&&(yield n.exportToOnlineWord(t,r,i,u))})}function a(t){return __awaiter(this,void 0,void 0,function*(){const r=yield n.createBlob(t),u=URL.createObjectURL(r),i=document.createElement("a");i.href=u;i.download="Creator_result.doc";document.body.appendChild(i);i.click();document.body.removeChild(i)})}function v(t,i,r,u){return __awaiter(this,void 0,void 0,function*(){return u?yield n.postHandoff(t,i):yield n.saveToOneDrive(t,r)})}function y(n,r){return __awaiter(this,void 0,void 0,function*(){const e=JSON.stringify({queryId:((1+Math.random())*65536|0).toString(16).substring(1),destinationApp:"word",language:"en-us",scenarioName:"generate",content:[{contentString:r,contentFormat:"markdown"}]}),o=yield i(n===t.OnlineWord1st,["https://augloop.office.com/v2/AugLoop.All"]),f=yield fetch("https://augloop.office.com/handoff",{method:"POST",headers:{"x-timeout":"30000",Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:e});if(!f.ok)throw new Error(`HTTP error! status: ${f.status}`);const{responses:u}=yield f.json();if(u&&u.length>0&&u[0].generatedLinks&&u[0].generatedLinks.length>0){const n=u[0].generatedLinks[0].platformHandoffUrl;if(!n)throw new Error("Unexpected response structure.");window.open(n,"_blank")}else throw new Error("No handoff URL found in the response.");})}function p(r,u){return __awaiter(this,void 0,void 0,function*(){const e=yield i(r===t.OnlineWord1st,["Files.ReadWrite"]);if(!e)throw new Error("Access token is empty.");const o=window.MicrosoftGraph.Client.init({authProvider:n=>{n(null,e)}});if(!o)return Promise.reject(new Error("Unable to get Microsoft Graph client"));const h=yield n.createBlob(u),f=yield o.api(`/me/drive/root:/Documents/${n.getFilename(r)}:/content`).put(h),s=f===null||f===void 0?void 0:f.webUrl;if(s)window.open(s,"_blank");else throw new Error("Callback URL is undefined or empty.");})}function i(n,t){return __awaiter(this,void 0,void 0,function*(){if(!window.MicrosoftGraph)return Promise.reject(new Error("MicrosoftGraph package is not loaded."));if(!window.msal)return Promise.reject(new Error("MSAL package is not loaded."));const f=location.origin,r=new window.msal.PublicClientApplication({auth:{clientId:location.hostname==="localhost"||location.hostname==="www.staging-bing-int.com"||!n?"984b1ad7-686f-44f7-953e-0501d3aa15fa":"e6c2449c-aafc-4709-a7a6-6a019e4b5377",authority:"https://login.microsoftonline.com/consumers",redirectUri:f},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!0},system:{iframeHashTimeout:1e4}});if(!r)return Promise.reject(new Error("Unable to create msal instance"));let i=null;try{const n=yield r.ssoSilent({scopes:t});n&&(i=n.accessToken)}catch(u){}if(!i)try{const n=yield r.acquireTokenSilent({scopes:t});n&&(i=n.accessToken)}catch(u){}if(!i)try{const n=yield r.loginPopup({scopes:t});n&&(i=n.accessToken)}catch(u){}return i?i:Promise.reject(new Error("Access token is empty."))})}function w(n){var t;return __awaiter(this,void 0,void 0,function*(){const i=yield((t=window.importShim)===null||t===void 0?void 0:t.call(window,"rms-answers-SharedStaticAssets-docx"));if(!i)return Promise.reject(new Error("Docx module is not loaded."));const r=[];for(const t of Array.from(n.children)){const n=u(i,t);console.log("ExportHelper: convertElementToParagraph result:",n);Array.isArray(n)?(console.log("ExportHelper: convertElementToParagraph result is an array:"),r.push(...n)):n&&(console.log("ExportHelper: convertElementToParagraph result is a single element:"),r.push(n))}const e=f(),o=new i.Document({styles:e,numbering:{config:[{reference:"numbering-ref",levels:[{level:0,format:"decimal",text:"%1.",alignment:"left",paragraph:{indent:{left:720,hanging:360},spacing:{before:0,after:0,line:276,lineRule:"auto"}},run:{font:"Arial",size:24}},{level:1,format:"lowerLetter",text:"%2.",alignment:"left",paragraph:{indent:{left:1440,hanging:360}}},{level:2,format:"lowerRoman",text:"%3.",alignment:"left",paragraph:{indent:{left:2160,hanging:360}}}]}]},sections:[{children:r}]});return i.Packer.toBlob(o)})}function u(n,t){function u(t,i={}){const f=[];if(t.nodeName==="BR")return[new r({"break":1})];if(t.nodeType===Node.TEXT_NODE){const n=t.textContent;(n===null||n===void 0?void 0:n.trim())&&f.push(new r(Object.assign({text:n},i)))}else if(t.nodeType===Node.ELEMENT_NODE){const e=t,o=e.tagName.toUpperCase();if(o==="A"&&e.hasAttribute("href")){const t=e.getAttribute("href"),u=e.textContent||t,o=new r(Object.assign({text:u,style:"Hyperlink",color:"0000FF",underline:{}},i));f.push(new n.ExternalHyperlink({children:[o],link:t}))}else{const n=Object.assign(Object.assign({},i),s[o]||{});e.childNodes.forEach(t=>{f.push(...u(t,n))})}}return f}function f(t,r=0,e=false){const o=[];for(const s of Array.from(t.children))if(s.tagName==="LI"){const c=Array.from(s.childNodes).filter(n=>!(n instanceof HTMLElement&&(n.tagName==="UL"||n.tagName==="OL"))),h=document.createElement("div");for(const n of c)h.appendChild(n.cloneNode(!0));const l=u(h),t={children:l,spacing:{before:i,after:i}};e?t.numbering={reference:"numbering-ref",level:r}:t.bullet={level:r};o.push(new n.Paragraph(t));for(const n of Array.from(s.children))n.tagName==="UL"?o.push(...f(n,r+1,!1)):n.tagName==="OL"&&o.push(...f(n,r+1,!0))}return o}var e;const{Paragraph:o,TextRun:r}=n,s={STRONG:{bold:!0},B:{bold:!0},EM:{italics:!0},I:{italics:!0},CODE:{font:"Courier New"},U:{underline:{}},DEL:{strike:!0},MARK:{highlight:"yellow"}};const i=(e={P:80,H1:160,H2:160,H3:160,H4:160,H5:160,H6:160}[t.tagName])!==null&&e!==void 0?e:80;if(/^H[1-6]$/.test(t.tagName))return new o({children:u(t),spacing:{before:i,after:i},style:{H1:"Heading1",H2:"Heading2",H3:"Heading3",H4:"Heading4",H5:"Heading5",H6:"Heading6"}[t.tagName]});if(t.tagName==="P")return new o({children:u(t),spacing:{before:i,after:i},style:"Paragraph"});if(t.tagName==="UL")return f(t,0,!1);if(t.tagName==="OL")return f(t,0,!0);if(t.tagName==="PRE"){const n=t.querySelector("code"),f=(n===null||n===void 0?void 0:n.textContent)||t.textContent||"",u=f.split("\n"),i=[];for(let n=0;n<u.length;n++)n>0&&i.push(new r({"break":1})),i.push(new r({text:u[n],style:"InlineCode"}));return new o({children:i,style:"CodeBlock"})}if(t.tagName==="HR")return new n.Paragraph({border:{bottom:{color:"000000",space:1,style:"single",size:6}},spacing:{before:200,after:200},children:[new n.TextRun("")]})}function f(){return{paragraphStyles:[{id:"Heading1",name:"Heading 1",basedOn:"Normal",next:"Normal",quickFormat:!0,run:{size:40,font:"Aptos (Body)"},paragraph:{spacing:{before:240,after:240}}},{id:"Heading2",name:"Heading 2",basedOn:"Normal",next:"Normal",quickFormat:!0,run:{size:36,font:"Aptos (Body)"},paragraph:{spacing:{before:240,after:240}}},{id:"Heading3",name:"Heading 3",basedOn:"Normal",next:"Normal",quickFormat:!0,run:{size:20,font:"Aptos (Body)"},paragraph:{spacing:{before:240,after:240}}},{id:"Heading4",name:"Heading 4",basedOn:"Normal",next:"Normal",quickFormat:!0,run:{size:20,font:"Aptos (Body)"},paragraph:{spacing:{before:240,after:240}}},{id:"Heading5",name:"Heading 5",basedOn:"Normal",next:"Normal",quickFormat:!0,run:{size:20,font:"Aptos (Body)"},paragraph:{spacing:{before:240,after:240}}},{id:"Heading6",name:"Heading 6",basedOn:"Normal",next:"Normal",quickFormat:!0,run:{size:20},paragraph:{spacing:{before:240,after:120}}},{id:"Paragraph",name:"Paragraph",basedOn:"Normal",next:"Normal",paragraph:{spacing:{before:120,after:120}},run:{font:"Aptos (Body)"}},{id:"CodeBlock",name:"Code Block",basedOn:"Normal",next:"Normal",run:{font:"Courier New",size:24,color:"000000"},paragraph:{spacing:{before:120,after:120},shading:{fill:"EEEEEE"}}},{id:"InlineCode",name:"Inline Code",basedOn:"Normal",run:{font:"Courier New",color:"000000",size:22,shading:{fill:"DDDDDD"}}}]}}function b(n){let r="";switch(n){case t.LocalWord:case t.OnlineWord1st:case t.OnlineWord:r="docx";break;case t.PDF:r="pdf";break;case t.Text:r="txt";break;default:r="docx"}const i=new Date,u=n=>(n<10?"0":"")+n,f=i.getFullYear(),e=u(i.getMonth()+1),o=u(i.getDate()),s=u(i.getHours()),h=u(i.getMinutes()),c=u(i.getSeconds());return`${"CreatorCard"}_${f}${e}${o}_${s}${h}${c}.${r}`}function r(n,t){const r=new Date,u=r.toISOString().split("T")[0];let i="Creator_result";if(t&&typeof t=="string"){const n=t.substring(0,50).replace(/[^\w\s-]/g,"").replace(/\s+/g,"_").toLowerCase();n&&(i=n)}return`${i}_${u}.${n}`}function k(n,t){return __awaiter(this,void 0,void 0,function*(){const f=n.innerText||n.textContent||"",e=new Blob([f],{type:"text/plain"}),u=URL.createObjectURL(e),i=document.createElement("a"),o=r("txt",t);i.href=u;i.download=o;document.body.appendChild(i);i.click();document.body.removeChild(i);URL.revokeObjectURL(u)})}function d(n,t){return __awaiter(this,void 0,void 0,function*(){const i=document.title,u=r("pdf",t);document.title=u;const f=e(n);yield h(f);document.title=i})}function e(n){var i;const r=n.cloneNode(!0);[".b_crtrm_code_header",".b_crtrm_pcopy",".no-print","hr"].forEach(n=>{const t=r.querySelectorAll(n);t.forEach(n=>n.remove())});const f=r.innerHTML||"",e=o(n),s=(i=window.getComputedStyle(document.documentElement))===null||i===void 0?void 0:i.backgroundColor,u=s==="rgba(0, 0, 0, 0)",t=new Date,h=`${t.getFullYear()}/${t.getMonth()+1}/${t.getDate()} ${t.getHours()}:${t.getMinutes()}`;return`
            <!DOCTYPE html>
            <html>
            <head>
                <meta charset="utf-8">
                <title>${document.title}</title>
                <style>
                    @page {
                        font-family: "Segoe UI";
                        font-size: 12px;

                        @top-left { 
                            content: "${h}"; 
                            color: #919191;
                        }
                        @bottom-left { 
                            content: "Bing Writer â€¢ Generated with AI"; 
                            font-weight: 600;
                            color: #123BB6;
                        }
                        @bottom-right { 
                            content: counter(page) "/" counter(pages); 
                            color: rgba(0, 0, 0, 0.50);
                        }
                    }

                    .pdf-print-content,
                    .pdf-print-content * {
                        -webkit-print-color-adjust: exact !important;
                        color-adjust: exact !important;
                        print-color-adjust: exact !important;
                    }

                    @media print {
                        .pdf-print-content * {
                            ${u?"color: rgba(0, 0, 0, 0.8) !important;":""}
                        }

                        .pdf-print-content code
                        {
                            ${u?"background: #f5f5f5 !important;":""}
                        }
                    }

                    ${e}
                </style>
            </head>
            <body>
                <div class="pdf-print-content">
                    ${f}
                </div>
            </body>
            </html>
        `}function o(n){var t;const i=[];try{if(n){const t=s(n);t&&i.push(t)}}catch(r){(t={}===null||{}===void 0?void 0:{}.trace)===null||t===void 0?void 0:t.call({},"creator","CreatorCard: getCurrentPageStyles Error: ",r)}return i.join("\n\n")}function s(n){const t=[],i=new Set,r=(n,u=0)=>{if(!i.has(n)&&!(u>10)){i.add(n);try{const h=window.getComputedStyle(n),o=n.tagName.toLowerCase(),f=n.className?`.${n.className.replace(/\s+/g,".")}`:"",s=n.id?`#${n.id}`:"";let i=o;s?i=s:f&&f!=="."&&(i=`${o}${f}`);u>0&&(i=`.pdf-print-content ${i}`);const e=[];["font-family","font-size","font-weight","font-style","font-variant","line-height","letter-spacing","word-spacing","text-transform","color","background","background-color","background-image","background-position","background-size","background-repeat","display","position","float","clear","overflow","overflow-x","overflow-y","margin","margin-top","margin-right","margin-bottom","margin-left","padding","padding-top","padding-right","padding-bottom","padding-left","border","border-width","border-style","border-color","border-top","border-right","border-bottom","border-left","border-radius","text-align","text-decoration","text-indent","text-shadow","white-space","word-wrap","word-break","list-style","list-style-type","list-style-position","list-style-image","opacity","visibility","z-index","cursor"].forEach(n=>{const t=h.getPropertyValue(n);t&&t!=="initial"&&t!=="normal"&&t!=="auto"&&t!=="none"&&t!=="0px"&&t!=="rgba(0, 0, 0, 0)"&&t!=="transparent"&&e.push(`${n}: ${t}`)});e.length>0&&t.push(`${i} {
    ${e.join(";\n    ")};
}`);const c=Array.from(n.children);c.forEach(n=>{n.nodeType===Node.ELEMENT_NODE&&r(n,u+1)})}catch(f){console.warn("Failed to extract element styles:",f)}}};return r(n,0),t.join("\n\n")}function h(n){return __awaiter(this,void 0,void 0,function*(){const t=c(n,"b_crtrm_pdf_iframe");return new Promise((n,i)=>{t.onload=()=>{const r=t.contentWindow;if(!r){i(new Error("Pdf iframe window is null."));return}r.print();r.onafterprint=()=>{n()};r.onerror=n=>i(n)},t.onerror=n=>i(n)})})}function c(n,t){const r=document.getElementById(t);r&&r.remove();const i=document.createElement("iframe");return i.id=t,i.style.display="none",i.srcdoc=n,document.body.appendChild(i),i}let t;(function(n){n.LocalWord="LocalWord";n.OnlineWord1st="OnlineWord1st";n.OnlineWord="OnlineWord";n.PDF="PDF";n.Text="TXT"})(t=n.ExportMode||(n.ExportMode={}));n.handleExportToWord=l;n.exportToLocalWord=a;n.exportToOnlineWord=v;n.postHandoff=y;n.saveToOneDrive=p;n.getAccessToken=i;n.createBlob=w;n.convertElementToParagraph=u;n.getDocxStyles=f;n.getFilename=b;n.generateFileName=r;n.exportToText=k;n.exportToPDF=d;n.createPdfHtml=e;n.getCurrentPageStyles=o;n.extractElementStyles=s;n.exportToPdfWithIframe=h;n.createPdfIframe=c})(ExportHelper||(ExportHelper={}))